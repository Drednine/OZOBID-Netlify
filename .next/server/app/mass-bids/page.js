(()=>{var e={};e.id=378,e.ids=[378],e.modules={812:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"F:\\\\00. Проекты веб дизайна и другое\\\\OZOBID\\\\OZOBID-Railway\\\\src\\\\app\\\\mass-bids\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"F:\\00. Проекты веб дизайна и другое\\OZOBID\\OZOBID-Railway\\src\\app\\mass-bids\\page.tsx","default")},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1630:e=>{"use strict";e.exports=require("http")},1645:e=>{"use strict";e.exports=require("net")},1820:e=>{"use strict";e.exports=require("os")},1997:e=>{"use strict";e.exports=require("punycode")},2412:e=>{"use strict";e.exports=require("assert")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},3997:e=>{"use strict";e.exports=require("tty")},4075:e=>{"use strict";e.exports=require("zlib")},4631:e=>{"use strict";e.exports=require("tls")},4735:e=>{"use strict";e.exports=require("events")},5223:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>l});var s=t(687),i=t(3210),n=t(6391),a=t(7605),d=t(3161);let o=({userId:e,credentials:r})=>{let[t,n]=(0,i.useState)([]),[o,l]=(0,i.useState)([]),[c,u]=(0,i.useState)(!1),[p,x]=(0,i.useState)(""),[h,m]=(0,i.useState)(new Set),{register:b,handleSubmit:f,watch:j,setValue:v}=(0,a.mN)({defaultValues:{campaignId:"",bidAction:"set",bidValue:100,minBid:50,maxBid:500}});(0,i.useEffect)(()=>{y()},[]);let y=async()=>{u(!0);try{let{data:e}=await (0,d.Ct)(r);e&&e.campaigns&&n(e.campaigns)}catch(e){console.error(e)}finally{u(!1)}},g=async e=>{u(!0);try{let{data:t}=await (0,d.hs)(r,e);t&&t.products&&l(t.products)}catch(e){console.error(e)}finally{u(!1)}},q=async e=>{if(0!==h.size){u(!0);try{let t=Array.from(h).map(r=>({campaignId:e.campaignId,productId:r,newBid:e.bidValue}));await (0,d._K)(r,t),x("Ставки успешно обновлены")}catch(e){console.error(e),x("Ошибка при обновлении ставок")}finally{u(!1)}}};return(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{children:"Массовое управление ставками"}),p&&(0,s.jsx)("div",{children:p}),(0,s.jsx)("div",{children:(0,s.jsxs)("form",{onSubmit:f(q),children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{children:"Выберите кампанию"}),(0,s.jsxs)("select",{...b("campaignId",{onChange:e=>g(e.target.value)}),children:[(0,s.jsx)("option",{value:"",children:"Выберите кампанию"}),t.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{children:"Новая ставка (руб.)"}),(0,s.jsx)("input",{type:"number",...b("bidValue")})]}),(0,s.jsx)("button",{type:"submit",disabled:c||0===h.size,children:c?"Обновление...":"Обновить ставки"})]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{children:"Товары в кампании"}),(0,s.jsxs)("div",{children:["Выбрано: ",h.size," из ",o.length]}),o.length>0?(0,s.jsxs)("table",{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Выбрать"}),(0,s.jsx)("th",{children:"Название"}),(0,s.jsx)("th",{children:"Текущая ставка"})]})}),(0,s.jsx)("tbody",{children:o.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("input",{type:"checkbox",onChange:()=>{let r=new Set(h);r.has(e.id)?r.delete(e.id):r.add(e.id),m(r)}})}),(0,s.jsx)("td",{children:e.name}),(0,s.jsxs)("td",{children:[e.bid," руб."]})]},e.id))})]}):(0,s.jsx)("div",{children:c?"Загрузка...":"Нет товаров для отображения"})]})]})},l=()=>{let[e,r]=(0,i.useState)(null),[t,a]=(0,i.useState)(null),[d,l]=(0,i.useState)(!0),[c,u]=(0,i.useState)("");(0,i.useEffect)(()=>{p()},[]);let p=async()=>{try{l(!0);let{data:e,error:t}=await n.ND.auth.getUser();if(t)throw Error(t.message);if(!e?.user)throw Error("Необходимо авторизоваться");r(e.user);let{data:s,error:i}=await n.ND.from("ozon_credentials").select("*").eq("user_id",e.user.id).eq("is_active",!0).single();if(i||!s)throw Error("Необходимо добавить учетные данные OZON");a({clientId:s.client_id,apiKey:s.api_key})}catch(e){u(e.message)}finally{l(!1)}};return d?(0,s.jsx)("div",{children:"Загрузка..."}):c?(0,s.jsx)("div",{className:"text-red-500",children:c}):(0,s.jsxs)("div",{className:"container mx-auto p-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Массовое управление ставками"}),(0,s.jsx)(o,{userId:e.id,credentials:t})]})}},5511:e=>{"use strict";e.exports=require("crypto")},5591:e=>{"use strict";e.exports=require("https")},7314:(e,r,t)=>{Promise.resolve().then(t.bind(t,812))},7473:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>a.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>l});var s=t(5239),i=t(8088),n=t(8170),a=t.n(n),d=t(893),o={};for(let e in d)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>d[e]);t.d(r,o);let l={children:["",{children:["mass-bids",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,812)),"F:\\00. Проекты веб дизайна и другое\\OZOBID\\OZOBID-Railway\\src\\app\\mass-bids\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,4431)),"F:\\00. Проекты веб дизайна и другое\\OZOBID\\OZOBID-Railway\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,5284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["F:\\00. Проекты веб дизайна и другое\\OZOBID\\OZOBID-Railway\\src\\app\\mass-bids\\page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/mass-bids/page",pathname:"/mass-bids",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},7910:e=>{"use strict";e.exports=require("stream")},8085:(e,r,t)=>{Promise.resolve().then(t.bind(t,5223))},8354:e=>{"use strict";e.exports=require("util")},9021:e=>{"use strict";e.exports=require("fs")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9428:e=>{"use strict";e.exports=require("buffer")},9551:e=>{"use strict";e.exports=require("url")}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[825,414,605,497],()=>t(7473));module.exports=s})();