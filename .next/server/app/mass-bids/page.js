(()=>{var e={};e.id=850,e.ids=[850],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9491:e=>{"use strict";e.exports=require("assert")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3849:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},1332:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>l});var r=s(482),i=s(9108),a=s(2563),n=s.n(a),o=s(8300),d={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);s.d(t,d);let l=["",{children:["mass-bids",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,5653)),"C:\\temp_ozobid\\src\\app\\mass-bids\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,1342)),"C:\\temp_ozobid\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\temp_ozobid\\src\\app\\mass-bids\\page.tsx"],u="/mass-bids/page",p={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/mass-bids/page",pathname:"/mass-bids",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},4803:(e,t,s)=>{Promise.resolve().then(s.bind(s,3959))},3959:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var r=s(5344),i=s(3729),a=s(8704),n=s(708),o=s(6804);let d=({userId:e,credentials:t})=>{let[s,a]=(0,i.useState)([]),[d,l]=(0,i.useState)([]),[c,u]=(0,i.useState)(!1),[p,x]=(0,i.useState)(""),[h,m]=(0,i.useState)(new Set),{register:j,handleSubmit:b,watch:g,setValue:y}=(0,n.cI)({defaultValues:{campaignId:"",bidAction:"set",bidValue:100,minBid:50,maxBid:500}});(0,i.useEffect)(()=>{f()},[]);let f=async()=>{u(!0);try{let{data:e}=await (0,o.x)(t);e&&e.campaigns&&a(e.campaigns)}catch(e){console.error(e)}finally{u(!1)}},q=async e=>{u(!0);try{let{data:s}=await (0,o.k9)(t,e);s&&s.products&&l(s.products)}catch(e){console.error(e)}finally{u(!1)}},v=async e=>{if(0!==h.size){u(!0);try{let s=Array.from(h).map(t=>({campaignId:e.campaignId,productId:t,newBid:e.bidValue}));await (0,o.ov)(t,s),x("Ставки успешно обновлены")}catch(e){console.error(e),x("Ошибка при обновлении ставок")}finally{u(!1)}}};return(0,r.jsxs)("div",{children:[r.jsx("h2",{children:"Массовое управление ставками"}),p&&r.jsx("div",{children:p}),r.jsx("div",{children:(0,r.jsxs)("form",{onSubmit:b(v),children:[(0,r.jsxs)("div",{children:[r.jsx("label",{children:"Выберите кампанию"}),(0,r.jsxs)("select",{...j("campaignId",{onChange:e=>q(e.target.value)}),children:[r.jsx("option",{value:"",children:"Выберите кампанию"}),s.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{children:"Новая ставка (руб.)"}),r.jsx("input",{type:"number",...j("bidValue")})]}),r.jsx("button",{type:"submit",disabled:c||0===h.size,children:c?"Обновление...":"Обновить ставки"})]})}),(0,r.jsxs)("div",{children:[r.jsx("h3",{children:"Товары в кампании"}),(0,r.jsxs)("div",{children:["Выбрано: ",h.size," из ",d.length]}),d.length>0?(0,r.jsxs)("table",{children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{children:[r.jsx("th",{children:"Выбрать"}),r.jsx("th",{children:"Название"}),r.jsx("th",{children:"Текущая ставка"})]})}),r.jsx("tbody",{children:d.map(e=>(0,r.jsxs)("tr",{children:[r.jsx("td",{children:r.jsx("input",{type:"checkbox",onChange:()=>{let t=new Set(h);t.has(e.id)?t.delete(e.id):t.add(e.id),m(t)}})}),r.jsx("td",{children:e.name}),(0,r.jsxs)("td",{children:[e.bid," руб."]})]},e.id))})]}):r.jsx("div",{children:c?"Загрузка...":"Нет товаров для отображения"})]})]})},l=()=>{let[e,t]=(0,i.useState)(null),[s,n]=(0,i.useState)(null),[o,l]=(0,i.useState)(!0),[c,u]=(0,i.useState)("");(0,i.useEffect)(()=>{p()},[]);let p=async()=>{try{l(!0);let{data:e,error:s}=await a.OQ.auth.getUser();if(s)throw Error(s.message);if(!e?.user)throw Error("Необходимо авторизоваться");t(e.user);let{data:r,error:i}=await a.OQ.from("ozon_credentials").select("*").eq("user_id",e.user.id).eq("is_active",!0).single();if(i||!r)throw Error("Необходимо добавить учетные данные OZON");n({clientId:r.client_id,apiKey:r.api_key})}catch(e){u(e.message)}finally{l(!1)}};return o?r.jsx("div",{children:"Загрузка..."}):c?r.jsx("div",{className:"text-red-500",children:c}):(0,r.jsxs)("div",{className:"container mx-auto p-4",children:[r.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Массовое управление ставками"}),r.jsx(d,{userId:e.id,credentials:s})]})}},5653:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>a,__esModule:()=>i,default:()=>n});let r=(0,s(6843).createProxy)(String.raw`C:\temp_ozobid\src\app\mass-bids\page.tsx`),{__esModule:i,$$typeof:a}=r,n=r.default}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[22,516,708,18],()=>s(1332));module.exports=r})();