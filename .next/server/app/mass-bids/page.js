(()=>{var e={};e.id=850,e.ids=[850],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9491:e=>{"use strict";e.exports=require("assert")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},7177:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>o,routeModule:()=>x,tree:()=>d});var r=s(7096),i=s(6132),a=s(7284),n=s.n(a),l=s(2564),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);s.d(t,c);let d=["",{children:["mass-bids",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1317)),"F:\\00. Проекты веб дизайна и другое\\OZOBID\\OZOBID-Railway\\src\\app\\mass-bids\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,9113)),"F:\\00. Проекты веб дизайна и другое\\OZOBID\\OZOBID-Railway\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],o=["F:\\00. Проекты веб дизайна и другое\\OZOBID\\OZOBID-Railway\\src\\app\\mass-bids\\page.tsx"],u="/mass-bids/page",p={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/mass-bids/page",pathname:"/mass-bids",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7374:(e,t,s)=>{Promise.resolve().then(s.bind(s,7842))},7842:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>MassBidsPage});var r=s(784),i=s(9885),a=s(5413),n=s(6558),l=s(9994);let components_MassBidManagementForm=({userId:e,credentials:t})=>{let[s,a]=(0,i.useState)([]),[c,d]=(0,i.useState)([]),[o,u]=(0,i.useState)(!1),[p,x]=(0,i.useState)(""),[h,m]=(0,i.useState)(new Set),{register:g,handleSubmit:j,watch:b,setValue:y}=(0,n.cI)({defaultValues:{campaignId:"",bidAction:"set",bidValue:100,minBid:50,maxBid:500}});(0,i.useEffect)(()=>{loadCampaigns()},[]);let loadCampaigns=async()=>{u(!0);try{let{data:e}=await (0,l.x)(t);e&&e.campaigns&&a(e.campaigns)}catch(e){console.error(e)}finally{u(!1)}},handleCampaignSelect=async e=>{u(!0);try{let{data:s}=await (0,l.k9)(t,e);s&&s.products&&d(s.products)}catch(e){console.error(e)}finally{u(!1)}},onSubmit=async e=>{if(0!==h.size){u(!0);try{let s=Array.from(h).map(t=>({campaignId:e.campaignId,productId:t,newBid:e.bidValue}));await (0,l.ov)(t,s),x("Ставки успешно обновлены")}catch(e){console.error(e),x("Ошибка при обновлении ставок")}finally{u(!1)}}};return(0,r.jsxs)("div",{children:[r.jsx("h2",{children:"Массовое управление ставками"}),p&&r.jsx("div",{children:p}),r.jsx("div",{children:(0,r.jsxs)("form",{onSubmit:j(onSubmit),children:[(0,r.jsxs)("div",{children:[r.jsx("label",{children:"Выберите кампанию"}),(0,r.jsxs)("select",{...g("campaignId",{onChange:e=>handleCampaignSelect(e.target.value)}),children:[r.jsx("option",{value:"",children:"Выберите кампанию"}),s.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{children:"Новая ставка (руб.)"}),r.jsx("input",{type:"number",...g("bidValue")})]}),r.jsx("button",{type:"submit",disabled:o||0===h.size,children:o?"Обновление...":"Обновить ставки"})]})}),(0,r.jsxs)("div",{children:[r.jsx("h3",{children:"Товары в кампании"}),(0,r.jsxs)("div",{children:["Выбрано: ",h.size," из ",c.length]}),c.length>0?(0,r.jsxs)("table",{children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{children:[r.jsx("th",{children:"Выбрать"}),r.jsx("th",{children:"Название"}),r.jsx("th",{children:"Текущая ставка"})]})}),r.jsx("tbody",{children:c.map(e=>(0,r.jsxs)("tr",{children:[r.jsx("td",{children:r.jsx("input",{type:"checkbox",onChange:()=>{let t=new Set(h);t.has(e.id)?t.delete(e.id):t.add(e.id),m(t)}})}),r.jsx("td",{children:e.name}),(0,r.jsxs)("td",{children:[e.bid," руб."]})]},e.id))})]}):r.jsx("div",{children:o?"Загрузка...":"Нет товаров для отображения"})]})]})};function MassBidsPage(){let[e,t]=(0,i.useState)(null),[s,n]=(0,i.useState)(null),[l,c]=(0,i.useState)(!0),[d,o]=(0,i.useState)("");(0,i.useEffect)(()=>{checkAuth()},[]);let checkAuth=async()=>{try{c(!0);let{data:e,error:s}=await a.OQ.auth.getUser();if(s)throw Error(s.message);if(!e?.user)throw Error("Необходимо авторизоваться");t(e.user);let{data:r,error:i}=await a.OQ.from("ozon_credentials").select("*").eq("user_id",e.user.id).eq("is_active",!0).single();if(i||!r)throw Error("Необходимо добавить учетные данные OZON");n({clientId:r.client_id,apiKey:r.api_key})}catch(e){o(e.message)}finally{c(!1)}};return l?r.jsx("div",{children:"Загрузка..."}):d?r.jsx("div",{className:"text-red-500",children:d}):(0,r.jsxs)("div",{className:"container mx-auto p-4",children:[r.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Массовое управление ставками"}),r.jsx(components_MassBidManagementForm,{userId:e.id,credentials:s})]})}},1317:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>a,default:()=>c});var r=s(5153);let i=(0,r.createProxy)(String.raw`F:\00. Проекты веб дизайна и другое\OZOBID\OZOBID-Railway\src\app\mass-bids\page.tsx`),{__esModule:a,$$typeof:n}=i,l=i.default,c=l}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[472,287,558,155,863],()=>__webpack_exec__(7177));module.exports=s})();